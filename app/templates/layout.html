<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}NutriMind{% endblock %}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Quicksand:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet">

    <!-- Tailwind Config -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#FF8B66", // Terracotta Pop
                        "primary-dark": "#e07a58",
                        "background-light": "#FDF6F0", // Almond Milk
                        "active-nav": "#333333",

                        // Dark Mode (Twilight)
                        "twilight-bg": "#07090F",
                        "twilight-surface": "#121826",
                        "twilight-accent": "#1C2436",
                        "neon-green": "#39FF14",
                        "neon-teal": "#2DD4BF",
                        "text-dim": "#94A3B8",
                        "text-bright": "#F8FAFC",

                        // Light Mode
                        "text-main": "#4A3B32",
                        "text-muted": "#8C7E72",
                        "surface": "#ffffff",
                        "surface-alt": "#F2E8DE",
                        "accent-protein": "#FFADAD",
                        "accent-carbs": "#FFD6A5",
                        "accent-fats": "#FDFFB6",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"],
                        "body": ["Quicksand", "sans-serif"],
                    },
                    boxShadow: {
                        "soft": "0 8px 24px -6px rgba(74, 59, 50, 0.08)",
                        "float": "0 10px 30px -10px rgba(74, 59, 50, 0.15)",
                        "glow-green": "0 0 15px rgba(57, 255, 20, 0.3)",
                        "glow-primary": "0 0 20px rgba(255, 139, 102, 0.5)",
                    },
                    borderRadius: {
                        "pod": "24px",
                    },
                    animation: {
                        "blob": "blob 10s infinite",
                        "fade-in": "fadeIn 0.5s ease-out",
                    },
                    keyframes: {
                        blob: {
                            "0%": { transform: "translate(0px, 0px) scale(1)" },
                            "33%": { transform: "translate(30px, -50px) scale(1.1)" },
                            "66%": { transform: "translate(-20px, 20px) scale(0.9)" },
                            "100%": { transform: "translate(0px, 0px) scale(1)" },
                        },
                        fadeIn: {
                            "0%": { opacity: "0", transform: "translateY(10px)" },
                            "100%": { opacity: "1", transform: "translateY(0)" },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .organic-blob {
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
        }

        .bouncy-click {
            transition: transform 0.1s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .bouncy-click:active {
            transform: scale(0.95);
        }

        .biolum-glow {
            filter: drop-shadow(0 0 8px currentColor);
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-twilight-bg text-text-main dark:text-text-bright font-display h-full flex flex-col transition-colors duration-500 overflow-x-hidden selection:bg-primary selection:text-white">

    <!-- Background Ambience -->
    <div class="fixed inset-0 pointer-events-none z-0 overflow-hidden">
        <div
            class="absolute top-0 left-0 w-[500px] h-[500px] bg-primary/10 dark:bg-primary/5 rounded-full blur-[100px] -translate-x-1/2 -translate-y-1/2 animate-blob">
        </div>
        <div
            class="absolute bottom-0 right-0 w-[400px] h-[400px] bg-neon-green/10 dark:bg-neon-green/5 rounded-full blur-[100px] translate-x-1/2 translate-y-1/3 animate-blob animation-delay-2000">
        </div>
    </div>

    <!-- Main Content -->
    <main
        class="flex-1 relative z-10 w-full max-w-md mx-auto flex flex-col h-full bg-white/30 dark:bg-twilight-surface/30 backdrop-blur-sm sm:border-x sm:border-white/20 dark:sm:border-white/5 shadow-2xl">
        {% block content %}{% endblock %}

        <!-- Bottom Spacer for Nav -->
        <div class="h-24"></div>
    </main>

    <!-- Bottom Navigation -->
    <div class="fixed bottom-6 left-0 right-0 z-50 flex justify-center px-4 pointer-events-none">
        <nav
            class="pointer-events-auto flex h-16 w-full max-w-[320px] items-center justify-between rounded-full bg-text-main dark:bg-twilight-surface px-6 shadow-2xl ring-1 ring-white/10 dark:ring-white/5">
            {% set nav_items = [
            ('home', 'potted_plant', '/dashboard'),
            ('pantry', 'nutrition', '/pantry'),
            ('garden', 'local_florist', '/garden'),
            ('profile', 'account_circle', '/profile')
            ] %}

            {% for id, icon, url in nav_items %}
            <a href="{{ url }}" class="group flex flex-col items-center justify-center gap-1 transition-all">
                {% if active_tab == id %}
                <div class="text-white dark:text-neon-green">
                    <span class="material-symbols-outlined text-[28px] fill-1">{{ icon }}</span>
                </div>
                <div class="h-1 w-1 rounded-full bg-primary dark:bg-neon-green shadow-glow-primary"></div>
                {% else %}
                <div
                    class="text-white/40 dark:text-text-dim hover:text-white dark:hover:text-text-bright transition-colors">
                    <span class="material-symbols-outlined text-[24px]">{{ icon }}</span>
                </div>
                <div class="h-1 w-1 rounded-full bg-transparent"></div>
                {% endif %}
            </a>
            {% endfor %}
        </nav>
    </div>

    <!-- Scripts -->
    <script>
        // Init stored theme
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }

        // Add theme toggler to window for sub-pages
        window.toggleTheme = function () {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
            }
        }
    </script>
    {% block scripts %}{% endblock %}
</body>

</html>